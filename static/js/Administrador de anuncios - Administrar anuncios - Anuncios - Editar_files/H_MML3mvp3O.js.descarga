if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("MessengerThreadSharedMediaHelper",["AsyncRequest","FBLogger","LogHistory","MercuryMessagingLightswitch","MessageSharedMediaIDStore.bs","MessengerThreadSharedMediaAfterQuery.graphql","MessengerThreadSharedMediaBeforeQuery.graphql","MessengerThreadSharedMediaFindQuery.graphql","WebGraphQLQueryHelper","nullthrows","performanceAbsoluteNow","promiseDone"],function(a,b,c,d,e,f){"use strict";var g,h=b("WebGraphQLQueryHelper").getLegacyQueryURI,i=b("LogHistory").getInstance("shared_media_helper"),j=0;a={search:function(a,c,d){var e=b("MessageSharedMediaIDStore.bs").getMessageIDForAttachmentID(c),f=j++,k=(g||(g=b("performanceAbsoluteNow")))(),l=new(b("AsyncRequest"))(h(b("nullthrows")(b("MessengerThreadSharedMediaFindQuery.graphql").params.id),{id:a,photoID:c,messageID:e}));b("MercuryMessagingLightswitch").guard(function(){i.debug("search request "+f,JSON.stringify({id:a,photoID:c,messageID:e,timestamp:k}))});b("promiseDone")(l.setAllowCrossPageTransition(!0).exec().then(function(a){return a.getPayload()}),function(h){var j=(g||(g=b("performanceAbsoluteNow")))();b("MercuryMessagingLightswitch").guard(function(){i.debug("search response "+f,JSON.stringify({id:a,photoID:c,messageID:e,timestamp:j,duration:j-k}))});d(h)},function(a){b("MercuryMessagingLightswitch").guard(function(){b("FBLogger")("messenger_shared_media").warn("Error while searching for shared media: "+a.errorDescription)})});return l},loadMorePrevious:function(a,c,d,e){a=new(b("AsyncRequest"))(h(b("nullthrows")(b("MessengerThreadSharedMediaAfterQuery.graphql").params.id),{id:a,after:c,first:d}));b("promiseDone")(a.setAllowCrossPageTransition(!0).exec().then(function(a){return a.getPayload()}),function(a){return e(a)},function(a){b("MercuryMessagingLightswitch").guard(function(){b("FBLogger")("messenger_shared_media").warn("Error while fetching previous media: "+a.errorDescription)})});return a},loadMoreLatest:function(a,c,d,e){a=new(b("AsyncRequest"))(h(b("nullthrows")(b("MessengerThreadSharedMediaBeforeQuery.graphql").params.id),{id:a,before:c,last:d}));b("promiseDone")(a.setAllowCrossPageTransition(!0).exec().then(function(a){return a.getPayload()}),function(a){return e(a)},function(a){b("MercuryMessagingLightswitch").guard(function(){b("FBLogger")("messenger_shared_media").warn("Error while fetching latest media: "+a.errorDescription)})});return a}};e.exports=a},null);